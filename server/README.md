# Gateway project server

Gateway project server is an express.js backend application that provides a restful api to manage our business logic.

## Dependencies

This application depends on the following programs:

- nodejs
- mongodb

## Configuration

Create a `.env` file <i>(if not created)</i> with the following configuration:

```sh
MONGO_ADDR=mongodb://localhost

NODE_ENV=development
NODE_HOST=localhost
NODE_PORT=8000
```

## Setup

To run the server follow the instructions:

- run mongodb in your machine
- inside of the project folder execute the following commands:
  - `npm install`
  - `npm build`
  - `npm start`

## Testing

Unit testing and Integration testing are setup usign `Jest` and `Supertest`.

Using the previous configuration. Inside of the project folder execute the following command:

```sh
npm test
```

## Database Models:

```
Gateway {
  _id: string,
  name: string,
  address: string,
  serial: string,
}

Peripheral {
  _id: string,
  uid: number,
  status: online|offline
  created: Date,
  vendor: string,
  gatewayId: string,
}
```

### Relationships

- `Gateway` has many `Peripherals` through `gatewayId` property.

### Notes:

Both models keeps default `_id` that mongodb ODM's provides for the documents. Although, it's known that the properties `serial` and `ui` of `Gateway` and `Peripheral` can behave as their respective identificators but:

- About `serial`, in my opinion if a user that inputs the data can be wrong the system must provide a chance to change the record. So, if you change the record there could broke links between Gateways and Peripherals, so I think it's a better approach to use some inmutable autogenerated field as `_id` for the references.

- About `uid`, I didnt knew if it was intended to be the indentificator, could be maybe "userId" or something.

Anyways, mongoose provides an easy way to aoid default `_id` and setup custom identificators.

Also mongo provides both relation types between Models, Embeded and Relations <i>(like relationals databases)</i>. In this project the Relational approach was used, because is easier to find, edit, delete a Peripheral given that they have their own Collection. Otherwise, to find a Peripheral with a given uid there can be heavy for the system to iterate over each Gateway.
